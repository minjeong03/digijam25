\doxysection{Loading\+State Class Reference}
\hypertarget{class_loading_state}{}\label{class_loading_state}\index{LoadingState@{LoadingState}}


A transitional \doxylink{class_game_state}{Game\+State} that asynchronously loads resources and then switches to the next \doxylink{class_game_state}{Game\+State}.  




{\ttfamily \#include $<$Loading\+State.\+h$>$}

Inheritance diagram for Loading\+State\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_loading_state}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_loading_state_ac696a3c24805322e0b09a104ceb132e8}{Loading\+State}} (std\+::function$<$ std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{class_game_state}{Game\+State}} $>$()$>$ \mbox{\hyperlink{class_loading_state_a40db3522932ae35699d1db2ab5d728b0}{next\+Factory}})
\begin{DoxyCompactList}\small\item\em Constructs a \doxylink{class_loading_state}{Loading\+State} that will transition to the \doxylink{class_game_state}{Game\+State} produced by next\+Factory. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_abece8e8c4a6e42ee1540b5130fc2fde7}{Load}} (const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context) override
\begin{DoxyCompactList}\small\item\em Starts asynchronous loading and prepares UI resources used during the loading screen. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_a84ce856d66c4167866a24f49d5c7f471}{Init}} (const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context) override
\begin{DoxyCompactList}\small\item\em Initializes loading-\/screen objects (progress text). \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_aaeb0439da526b6933f6b61bde194a64f}{Late\+Init}} (const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context) override
\begin{DoxyCompactList}\small\item\em Late initialization hook for the loading state. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_a56063d7d8b5ae48cbbee33d16aad3e93}{Update}} (float dt, const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context) override
\begin{DoxyCompactList}\small\item\em Fetches completed load jobs, uploads results to GPU/systems, updates UI, and transitions when finished. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_a7f934a83650c18f8603320de29a18fbe}{Late\+Update}} (float dt, const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context) override
\begin{DoxyCompactList}\small\item\em Late update hook for the loading state. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_a9d7471af478429371619bff2ccda0e2a}{Draw}} (const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context) override
\begin{DoxyCompactList}\small\item\em Draws the loading progress bar and renders loading-\/screen objects. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_a1f2fb872ba3b6dbcb11bfbc46b72c386}{Free}} (const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context) override
\begin{DoxyCompactList}\small\item\em Releases resources owned by the loading state and stops the loader. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_a3754de47c0b00b40517645df5e5625cf}{Unload}} (const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context) override
\begin{DoxyCompactList}\small\item\em Unloads the loading state. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_af0573a8838bb173f6bd6c6a881931cd8}{Queue\+Texture}} (const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context, const std\+::string \&tag, const std\+::string \&file\+Path, const \mbox{\hyperlink{struct_texture_settings}{Texture\+Settings}} \&settings=\{\})
\begin{DoxyCompactList}\small\item\em Enqueues an asynchronous texture load job if the texture tag is not already registered. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_aeeeb157f13d158cd0d4ae1590dec2178}{Queue\+Shader}} (const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context, const std\+::string \&tag, const std\+::vector$<$ std\+::pair$<$ \mbox{\hyperlink{_shader_8h_a22fa67f5720e9bfbd075bd088285c531}{Shader\+Stage}}, \mbox{\hyperlink{_render_manager_8h_a1db05f4e4bd57f5e7db00f908dab03be}{File\+Path}} $>$ $>$ \&files)
\begin{DoxyCompactList}\small\item\em Enqueues an asynchronous shader load job if the shader tag is not already registered. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_a6f683c033cd51cf736410353556ff668}{Queue\+Font}} (const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context, const std\+::string \&tag, const std\+::string \&ttf\+Path, uint32\+\_\+t pixel\+Size)
\begin{DoxyCompactList}\small\item\em Enqueues an asynchronous font load job if the font tag is not already registered. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_ae0f36c66d2fdfd6b186b49dac023ca27}{Queue\+Sound}} (const std\+::string \&tag, const std\+::string \&path, bool loop)
\begin{DoxyCompactList}\small\item\em Enqueues an asynchronous sound load job. \end{DoxyCompactList}\item 
float \mbox{\hyperlink{class_loading_state_a2a2abd4d6eae2b9f012e02bdc718dd69}{Get\+Progress01}} () const
\begin{DoxyCompactList}\small\item\em Returns overall loading progress as a normalized value in \mbox{[}0, 1\mbox{]}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_loading_state_a8d02a948b169581ad59b589c67f1f589}{Upload\+To\+GPU}} (const \mbox{\hyperlink{_async_resource_loader_8h_a6a60ad85728d8591ed1f4246e5d3af21}{Load\+Result}} \&r, const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context)
\begin{DoxyCompactList}\small\item\em Applies a completed load result to engine runtime systems (GPU upload / registration). \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{class_game_state}{Game\+State}}}
\begin{DoxyCompactItemize}
\item 
virtual \mbox{\hyperlink{class_game_state_adc1bfdf7ee7c1f48e4841995db4e16c3}{\texorpdfstring{$\sim$}{\string~}\+Game\+State}} ()=default
\begin{DoxyCompactList}\small\item\em Virtual destructor for \doxylink{class_game_state}{Game\+State}. \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{class_object_manager}{Object\+Manager}} \& \mbox{\hyperlink{class_game_state_abea569338b92e0b499193fdbdab94e86}{Get\+Object\+Manager}} ()
\begin{DoxyCompactList}\small\item\em Returns the \doxylink{class_object_manager}{Object\+Manager} owned by this game state. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_camera_manager}{Camera\+Manager}} \& \mbox{\hyperlink{class_game_state_a116bca1d8804cda67f37e199eb470dfd}{Get\+Camera\+Manager}} ()
\begin{DoxyCompactList}\small\item\em Returns the \doxylink{class_camera_manager}{Camera\+Manager} owned by this game state. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_camera2_d}{Camera2D}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{class_game_state_aca3df3a97dc9c97a03665bc1842ffd78}{Get\+Active\+Camera}} () const
\begin{DoxyCompactList}\small\item\em Returns the currently active \doxylink{class_camera2_d}{Camera2D}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_game_state_aadc8c33fe485c1f8ac9bccaec1cebe74}{Set\+Active\+Camera}} (const std\+::string \&tag)
\begin{DoxyCompactList}\small\item\em Sets the active camera using a registered camera tag. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_async_resource_loader}{Async\+Resource\+Loader}} \mbox{\hyperlink{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219}{loader}}
\item 
std\+::function$<$ std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{class_game_state}{Game\+State}} $>$()$>$ \mbox{\hyperlink{class_loading_state_a40db3522932ae35699d1db2ab5d728b0}{next\+Factory}}
\item 
std\+::string \mbox{\hyperlink{class_loading_state_a27df9fbc8edb1b1a7f2ec5d52af2f50f}{ui\+Font\+Tag}} = "{}\mbox{[}Loading\mbox{]}UIFont"{}
\item 
bool \mbox{\hyperlink{class_loading_state_aebe9d65f3f4ff289a2d0b76f020e5c1e}{ui\+Ready}} = false
\item 
\mbox{\hyperlink{class_text_object}{Text\+Object}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{class_loading_state_aecfe4e3c0b70523fe2f15935743340a3}{progress\+Text}} = nullptr
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{class_game_state}{Game\+State}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_object_manager}{Object\+Manager}} \mbox{\hyperlink{class_game_state_a688b4f8864623a3d8e9ad873434b062e}{object\+Manager}}
\item 
\mbox{\hyperlink{class_camera_manager}{Camera\+Manager}} \mbox{\hyperlink{class_game_state_a8791f5177bdd9959553a98bac8cf092b}{camera\+Manager}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{class_game_state}{Game\+State}}}
\begin{DoxyCompactItemize}
\item 
virtual void \mbox{\hyperlink{class_game_state_a5b46058b4310096491ff70ed2fccc94d}{Post\+Processing}} (const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context)
\begin{DoxyCompactList}\small\item\em Applies post-\/processing effects. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_game_state_a279f1dc798ad39da9329dc73c1c85933}{Restart}} (const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&engine\+Context)
\begin{DoxyCompactList}\small\item\em Restarts the game state. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
A transitional \doxylink{class_game_state}{Game\+State} that asynchronously loads resources and then switches to the next \doxylink{class_game_state}{Game\+State}. 

\doxylink{class_loading_state}{Loading\+State} owns an \doxylink{class_async_resource_loader}{Async\+Resource\+Loader} and provides a queue-\/style API (Queue\+Texture/\+Queue\+Shader/\+Queue\+Font/\+Queue\+Sound) for scheduling resource loads on worker threads. Each frame, it fetches completed load results and uploads them to engine-\/managed systems (Render\+Manager/\+Sound\+Manager).

Flow (based on \doxylink{_loading_state_8cpp}{Loading\+State.\+cpp})\+:
\begin{DoxyItemize}
\item \doxylink{class_loading_state_abece8e8c4a6e42ee1540b5130fc2fde7}{Load()}\+:
\begin{DoxyItemize}
\item Starts the loader.
\item Ensures a UI font is registered (ui\+Font\+Tag), then marks UI as ready.
\end{DoxyItemize}
\item \doxylink{class_loading_state_a84ce856d66c4167866a24f49d5c7f471}{Init()}\+:
\begin{DoxyItemize}
\item If UI is ready, creates a screen-\/space \doxylink{class_text_object}{Text\+Object} showing loading progress and registers it via \doxylink{class_object_manager}{Object\+Manager}.
\end{DoxyItemize}
\item \doxylink{class_loading_state_a56063d7d8b5ae48cbbee33d16aad3e93}{Update()}\+:
\begin{DoxyItemize}
\item Fetches completed results and uploads them to GPU / systems.
\item Updates the progress text.
\item When loading finishes, fetches any remaining results, uploads them, then requests \doxylink{class_state_manager}{State\+Manager} to change to \doxylink{class_loading_state_a40db3522932ae35699d1db2ab5d728b0}{next\+Factory()}.
\end{DoxyItemize}
\item \doxylink{class_loading_state_a9d7471af478429371619bff2ccda0e2a}{Draw()}\+:
\begin{DoxyItemize}
\item Draws a simple progress bar using \doxylink{class_render_manager_a80b5e6df0bbbb276abb3a2da87bb2007}{Render\+Manager\+::\+Clear\+Background} and draws all objects (including the progress text).
\end{DoxyItemize}
\item \doxylink{class_loading_state_a1f2fb872ba3b6dbcb11bfbc46b72c386}{Free()}\+:
\begin{DoxyItemize}
\item Stops the loader.
\end{DoxyItemize}
\end{DoxyItemize}

next\+Factory\+:
\begin{DoxyItemize}
\item A factory callback that creates the next \doxylink{class_game_state}{Game\+State} once loading has completed. 
\end{DoxyItemize}

Definition at line \mbox{\hyperlink{_loading_state_8h_source_l00032}{32}} of file \mbox{\hyperlink{_loading_state_8h_source}{Loading\+State.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{class_loading_state_ac696a3c24805322e0b09a104ceb132e8}\index{LoadingState@{LoadingState}!LoadingState@{LoadingState}}
\index{LoadingState@{LoadingState}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{LoadingState()}{LoadingState()}}
{\footnotesize\ttfamily \label{class_loading_state_ac696a3c24805322e0b09a104ceb132e8} 
Loading\+State\+::\+Loading\+State (\begin{DoxyParamCaption}\item[{std\+::function$<$ std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{class_game_state}{Game\+State}} $>$()$>$}]{next\+Factory}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [explicit]}}



Constructs a \doxylink{class_loading_state}{Loading\+State} that will transition to the \doxylink{class_game_state}{Game\+State} produced by next\+Factory. 

next\+Factory is stored and invoked once the \doxylink{class_async_resource_loader}{Async\+Resource\+Loader} reports completion. If next\+Factory is null, the state will not automatically transition.


\begin{DoxyParams}{Parameters}
{\em next\+Factory} & Factory function that returns the next \doxylink{class_game_state}{Game\+State} to run after loading completes. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00003}{3}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00004\ \ \ \ \ :\ \mbox{\hyperlink{class_loading_state_a40db3522932ae35699d1db2ab5d728b0}{nextFactory}}(std::move(nextFactory\_)) }
\DoxyCodeLine{00005\ \{}
\DoxyCodeLine{00006\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{class_loading_state_a9d7471af478429371619bff2ccda0e2a}\index{LoadingState@{LoadingState}!Draw@{Draw}}
\index{Draw@{Draw}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{Draw()}{Draw()}}
{\footnotesize\ttfamily \label{class_loading_state_a9d7471af478429371619bff2ccda0e2a} 
void Loading\+State\+::\+Draw (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&}]{engine\+Context}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Draws the loading progress bar and renders loading-\/screen objects. 

\doxylink{class_loading_state_a9d7471af478429371619bff2ccda0e2a}{Draw()} computes a centered progress bar rectangle based on the current window size. It draws\+:
\begin{DoxyItemize}
\item a dark background bar
\item a filled bar whose width is barW \texorpdfstring{$\ast$}{*} \doxylink{class_loading_state_a2a2abd4d6eae2b9f012e02bdc718dd69}{Get\+Progress01()}
\end{DoxyItemize}

Then it draws all objects via Object\+Manager\+::\+Draw\+All(engine\+Context) (including progress\+Text).


\begin{DoxyParams}{Parameters}
{\em engine\+Context} & Engine-\/wide context providing access to \doxylink{class_window_manager}{Window\+Manager} and \doxylink{class_render_manager}{Render\+Manager}. \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{class_game_state_ab3f79ba850091b4853d800b1ff2e2974}{Game\+State}}.



Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00070}{70}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00071\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ w\ =\ engineContext.\mbox{\hyperlink{struct_engine_context_ab6fa006055c2a224931059f7ed840bed}{windowManager}}-\/>\mbox{\hyperlink{class_window_manager_ad8e16ad88c8eb3e3889d5c3dbe7891cb}{GetWidth}}();}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ h\ =\ engineContext.\mbox{\hyperlink{struct_engine_context_ab6fa006055c2a224931059f7ed840bed}{windowManager}}-\/>\mbox{\hyperlink{class_window_manager_a50c9f12a67f69e822b4e70077773c9ca}{GetHeight}}();}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ barW\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(w\ *\ 0.6f);}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ barH\ =\ 24;}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ x\ =\ (w\ -\/\ barW)\ /\ 2;}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ y\ =\ h\ /\ 2\ -\/\ barH;}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ engineContext.\mbox{\hyperlink{struct_engine_context_a8f4c861adc4684975fa767ae4723e095}{renderManager}}-\/>\mbox{\hyperlink{class_render_manager_a80b5e6df0bbbb276abb3a2da87bb2007}{ClearBackground}}(x,\ y,\ barW,\ barH,\ \{\ 0.2f,\ 0.2f,\ 0.2f,\ 1.0f\ \});}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordtype}{int}\ filled\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(barW\ *\ \mbox{\hyperlink{class_loading_state_a2a2abd4d6eae2b9f012e02bdc718dd69}{GetProgress01}}());}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordflow}{if}\ (filled\ >\ 0)}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ engineContext.\mbox{\hyperlink{struct_engine_context_a8f4c861adc4684975fa767ae4723e095}{renderManager}}-\/>\mbox{\hyperlink{class_render_manager_a80b5e6df0bbbb276abb3a2da87bb2007}{ClearBackground}}(x,\ y,\ filled,\ barH,\ \{\ 0.1f,\ 0.4f,\ 1.0f,\ 1.0f\ \});}
\DoxyCodeLine{00085\ \ \ \ \ \mbox{\hyperlink{class_game_state_a688b4f8864623a3d8e9ad873434b062e}{objectManager}}.DrawAll(engineContext);}
\DoxyCodeLine{00086\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_a1f2fb872ba3b6dbcb11bfbc46b72c386}\index{LoadingState@{LoadingState}!Free@{Free}}
\index{Free@{Free}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{Free()}{Free()}}
{\footnotesize\ttfamily \label{class_loading_state_a1f2fb872ba3b6dbcb11bfbc46b72c386} 
void Loading\+State\+::\+Free (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&}]{engine\+Context}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Releases resources owned by the loading state and stops the loader. 

Calls loader.\+Stop(). Actual resource ownership is handled by Render\+Manager/\+Sound\+Manager after upload.


\begin{DoxyParams}{Parameters}
{\em engine\+Context} & Engine-\/wide context. \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{class_game_state_a46b0b108e44fa42845f27d20bc242d93}{Game\+State}}.



Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00092}{92}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00093\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \mbox{\hyperlink{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219}{loader}}.Stop();}
\DoxyCodeLine{00095\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_a2a2abd4d6eae2b9f012e02bdc718dd69}\index{LoadingState@{LoadingState}!GetProgress01@{GetProgress01}}
\index{GetProgress01@{GetProgress01}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{GetProgress01()}{GetProgress01()}}
{\footnotesize\ttfamily \label{class_loading_state_a2a2abd4d6eae2b9f012e02bdc718dd69} 
float Loading\+State\+::\+Get\+Progress01 (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [nodiscard]}}



Returns overall loading progress as a normalized value in \mbox{[}0, 1\mbox{]}. 

This forwards to \doxylink{class_async_resource_loader_a5689fa771581393a3186273928d5fae0}{Async\+Resource\+Loader\+::\+Get\+Progress()}.

\begin{DoxyReturn}{Returns}
Loading progress ratio. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{_loading_state_8h_source_l00204}{204}} of file \mbox{\hyperlink{_loading_state_8h_source}{Loading\+State.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00204\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219}{loader}}.GetProgress();\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_a84ce856d66c4167866a24f49d5c7f471}\index{LoadingState@{LoadingState}!Init@{Init}}
\index{Init@{Init}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{Init()}{Init()}}
{\footnotesize\ttfamily \label{class_loading_state_a84ce856d66c4167866a24f49d5c7f471} 
void Loading\+State\+::\+Init (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&}]{engine\+Context}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Initializes loading-\/screen objects (progress text). 

If ui\+Ready is true and the UI font can be retrieved, creates a \doxylink{class_text_object}{Text\+Object} displaying "{}\+Loading... 0\%"{} and configures it as screen-\/space by calling Set\+Ignore\+Camera(true, Get\+Active\+Camera()). The created \doxylink{class_text_object}{Text\+Object} is added to the \doxylink{class_object_manager}{Object\+Manager} and its alignment is set to centered.


\begin{DoxyParams}{Parameters}
{\em engine\+Context} & Engine-\/wide context. \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{class_game_state_ab4bdccf42209d9d3465a33739ad59646}{Game\+State}}.



Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00018}{18}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00019\ \{}
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_loading_state_aebe9d65f3f4ff289a2d0b76f020e5c1e}{uiReady}})}
\DoxyCodeLine{00021\ \ \ \ \ \{}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}*\ font\ =\ engineContext.\mbox{\hyperlink{struct_engine_context_a8f4c861adc4684975fa767ae4723e095}{renderManager}}-\/>\mbox{\hyperlink{class_render_manager_a1db9a464555a13cecb1a865f92eae85c}{GetFontByTag}}(\mbox{\hyperlink{class_loading_state_a27df9fbc8edb1b1a7f2ec5d52af2f50f}{uiFontTag}});}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (font)}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ text\ =\ std::make\_unique<TextObject>(font,\ \textcolor{stringliteral}{"{}Loading...\ 0\%"{}});}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \ \ \ \ text-\/>SetIgnoreCamera(\textcolor{keyword}{true},\ \mbox{\hyperlink{class_game_state_aca3df3a97dc9c97a03665bc1842ffd78}{GetActiveCamera}}());}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \ \ \ \ text-\/>GetTransform2D().SetPosition(\{\ 0.0f,\ -\/50.0f\ \});}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_loading_state_aecfe4e3c0b70523fe2f15935743340a3}{progressText}}\ =\ \textcolor{keyword}{static\_cast<}TextObject*\textcolor{keyword}{>}(\mbox{\hyperlink{class_game_state_abea569338b92e0b499193fdbdab94e86}{GetObjectManager}}().\mbox{\hyperlink{class_object_manager_ae1f29824763903213d6044d463742db4}{AddObject}}(std::move(text),\ \textcolor{stringliteral}{"{}[Loading]ProgressText"{}}));}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_loading_state_aecfe4e3c0b70523fe2f15935743340a3}{progressText}}-\/>SetAlignH(\mbox{\hyperlink{_font_8h_adba6445b3653352a2f932f18e80c4c44a4f1f6016fc9f3f2353c0cc7c67b292bd}{TextAlignH::Center}});}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_loading_state_aecfe4e3c0b70523fe2f15935743340a3}{progressText}}-\/>SetAlignV(\mbox{\hyperlink{_font_8h_adddce2e8703c25cb1fda789220605572ab1ca34f82e83c52b010f86955f264e05}{TextAlignV::Middle}});}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00032\ \ \ \ \ \}}
\DoxyCodeLine{00033\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_aaeb0439da526b6933f6b61bde194a64f}\index{LoadingState@{LoadingState}!LateInit@{LateInit}}
\index{LateInit@{LateInit}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{LateInit()}{LateInit()}}
{\footnotesize\ttfamily \label{class_loading_state_aaeb0439da526b6933f6b61bde194a64f} 
void Loading\+State\+::\+Late\+Init (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&}]{engine\+Context}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Late initialization hook for the loading state. 

Forwards to Game\+State\+::\+Late\+Init(engine\+Context).


\begin{DoxyParams}{Parameters}
{\em engine\+Context} & Engine-\/wide context. \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{class_game_state_a98a9fbfcd4afe6bcd90fc94d5aa93b85}{Game\+State}}.



Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00035}{35}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00036\ \{}
\DoxyCodeLine{00037\ \ \ \ \ \mbox{\hyperlink{class_game_state_a98a9fbfcd4afe6bcd90fc94d5aa93b85}{GameState::LateInit}}(engineContext);}
\DoxyCodeLine{00038\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_a7f934a83650c18f8603320de29a18fbe}\index{LoadingState@{LoadingState}!LateUpdate@{LateUpdate}}
\index{LateUpdate@{LateUpdate}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{LateUpdate()}{LateUpdate()}}
{\footnotesize\ttfamily \label{class_loading_state_a7f934a83650c18f8603320de29a18fbe} 
void Loading\+State\+::\+Late\+Update (\begin{DoxyParamCaption}\item[{float}]{dt}{, }\item[{const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&}]{engine\+Context}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Late update hook for the loading state. 

Forwards to Game\+State\+::\+Late\+Update(dt, engine\+Context).


\begin{DoxyParams}{Parameters}
{\em dt} & Delta time in seconds. \\
\hline
{\em engine\+Context} & Engine-\/wide context. \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{class_game_state_a5079b8eccc7846e03e17917e07d6da3f}{Game\+State}}.



Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00065}{65}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00066\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \mbox{\hyperlink{class_game_state_a5079b8eccc7846e03e17917e07d6da3f}{GameState::LateUpdate}}(dt,\ engineContext);}
\DoxyCodeLine{00068\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_abece8e8c4a6e42ee1540b5130fc2fde7}\index{LoadingState@{LoadingState}!Load@{Load}}
\index{Load@{Load}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{Load()}{Load()}}
{\footnotesize\ttfamily \label{class_loading_state_abece8e8c4a6e42ee1540b5130fc2fde7} 
void Loading\+State\+::\+Load (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&}]{engine\+Context}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Starts asynchronous loading and prepares UI resources used during the loading screen. 

Starts \doxylink{class_async_resource_loader}{Async\+Resource\+Loader}. Ensures the loading UI font is registered in \doxylink{class_render_manager}{Render\+Manager} under ui\+Font\+Tag. Sets ui\+Ready to true so \doxylink{class_loading_state_a84ce856d66c4167866a24f49d5c7f471}{Init()} can spawn UI objects.


\begin{DoxyParams}{Parameters}
{\em engine\+Context} & Engine-\/wide context providing access to \doxylink{class_render_manager}{Render\+Manager}. \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{class_game_state_a89713af22cf5b07b602c3315b1f90296}{Game\+State}}.



Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00008}{8}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00009\ \{}
\DoxyCodeLine{00010\ \ \ \ \ \mbox{\hyperlink{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219}{loader}}.Start();}
\DoxyCodeLine{00011\ \ \ \ \ \textcolor{keywordflow}{if}\ (!engineContext.\mbox{\hyperlink{struct_engine_context_a8f4c861adc4684975fa767ae4723e095}{renderManager}}-\/>\mbox{\hyperlink{class_render_manager_a125f91cca7722e193b0d60f408f50858}{HasFont}}(\mbox{\hyperlink{class_loading_state_a27df9fbc8edb1b1a7f2ec5d52af2f50f}{uiFontTag}}))}
\DoxyCodeLine{00012\ \ \ \ \ \{}
\DoxyCodeLine{00013\ \ \ \ \ \ \ \ \ engineContext.\mbox{\hyperlink{struct_engine_context_a8f4c861adc4684975fa767ae4723e095}{renderManager}}-\/>\mbox{\hyperlink{class_render_manager_a0762465f3bfa7573ec3261767a68eb16}{RegisterFont}}(\mbox{\hyperlink{class_loading_state_a27df9fbc8edb1b1a7f2ec5d52af2f50f}{uiFontTag}},\ \textcolor{stringliteral}{"{}Fonts/font1.ttf"{}},\ 32);}
\DoxyCodeLine{00014\ \ \ \ \ \}}
\DoxyCodeLine{00015\ \ \ \ \ \mbox{\hyperlink{class_loading_state_aebe9d65f3f4ff289a2d0b76f020e5c1e}{uiReady}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00016\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_a6f683c033cd51cf736410353556ff668}\index{LoadingState@{LoadingState}!QueueFont@{QueueFont}}
\index{QueueFont@{QueueFont}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{QueueFont()}{QueueFont()}}
{\footnotesize\ttfamily \label{class_loading_state_a6f683c033cd51cf736410353556ff668} 
void Loading\+State\+::\+Queue\+Font (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&}]{engine\+Context}{, }\item[{const std\+::string \&}]{tag}{, }\item[{const std\+::string \&}]{ttf\+Path}{, }\item[{uint32\+\_\+t}]{pixel\+Size}{}\end{DoxyParamCaption})}



Enqueues an asynchronous font load job if the font tag is not already registered. 

If \doxylink{class_render_manager}{Render\+Manager} already has a font registered for tag, the request is ignored. Otherwise, a \doxylink{struct_font_job}{Font\+Job} is enqueued.


\begin{DoxyParams}{Parameters}
{\em engine\+Context} & Engine-\/wide context (used to query \doxylink{class_render_manager}{Render\+Manager}). \\
\hline
{\em tag} & \doxylink{class_font}{Font} tag to register under. \\
\hline
{\em ttf\+Path} & Path to a .ttf file. \\
\hline
{\em pixel\+Size} & \doxylink{class_font}{Font} pixel size used when creating the \doxylink{class_font}{Font}. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00117}{117}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00118\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordflow}{if}\ (engineContext.\mbox{\hyperlink{struct_engine_context_a8f4c861adc4684975fa767ae4723e095}{renderManager}}-\/>\mbox{\hyperlink{class_render_manager_a125f91cca7722e193b0d60f408f50858}{HasFont}}(tag))}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00121\ \ \ \ \ \mbox{\hyperlink{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219}{loader}}.Enqueue(FontJob\{\ tag,\ ttfPath,\ pixelSize\ \});}
\DoxyCodeLine{00122\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_aeeeb157f13d158cd0d4ae1590dec2178}\index{LoadingState@{LoadingState}!QueueShader@{QueueShader}}
\index{QueueShader@{QueueShader}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{QueueShader()}{QueueShader()}}
{\footnotesize\ttfamily \label{class_loading_state_aeeeb157f13d158cd0d4ae1590dec2178} 
void Loading\+State\+::\+Queue\+Shader (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&}]{engine\+Context}{, }\item[{const std\+::string \&}]{tag}{, }\item[{const std\+::vector$<$ std\+::pair$<$ \mbox{\hyperlink{_shader_8h_a22fa67f5720e9bfbd075bd088285c531}{Shader\+Stage}}, \mbox{\hyperlink{_render_manager_8h_a1db05f4e4bd57f5e7db00f908dab03be}{File\+Path}} $>$ $>$ \&}]{files}{}\end{DoxyParamCaption})}



Enqueues an asynchronous shader load job if the shader tag is not already registered. 

If \doxylink{class_render_manager}{Render\+Manager} already has a shader registered for tag, the request is ignored. Otherwise, a \doxylink{struct_shader_job}{Shader\+Job} is built from (stage, file path) pairs and enqueued.


\begin{DoxyParams}{Parameters}
{\em engine\+Context} & Engine-\/wide context (used to query \doxylink{class_render_manager}{Render\+Manager}). \\
\hline
{\em tag} & \doxylink{class_shader}{Shader} tag to register under. \\
\hline
{\em files} & List of shader stage + file path pairs to load and compile. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00106}{106}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00107\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keywordflow}{if}\ (engineContext.\mbox{\hyperlink{struct_engine_context_a8f4c861adc4684975fa767ae4723e095}{renderManager}}-\/>\mbox{\hyperlink{class_render_manager_af2a96d2e81a279531985c0f1ef093e76}{HasShader}}(tag))}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00110\ \ \ \ \ ShaderJob\ job;}
\DoxyCodeLine{00111\ \ \ \ \ job.\mbox{\hyperlink{struct_shader_job_a1bcf780b68eb6f40150fae5d7cc83df5}{tag}}\ =\ tag;}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ f\ :\ files)}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ job.\mbox{\hyperlink{struct_shader_job_a5eb2b74c79feb2632bb8a0e9ec39f0fc}{sources}}.push\_back(ShaderFile\{\ f.first,\ f.second\ \});}
\DoxyCodeLine{00114\ \ \ \ \ \mbox{\hyperlink{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219}{loader}}.Enqueue(job);}
\DoxyCodeLine{00115\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_ae0f36c66d2fdfd6b186b49dac023ca27}\index{LoadingState@{LoadingState}!QueueSound@{QueueSound}}
\index{QueueSound@{QueueSound}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{QueueSound()}{QueueSound()}}
{\footnotesize\ttfamily \label{class_loading_state_ae0f36c66d2fdfd6b186b49dac023ca27} 
void Loading\+State\+::\+Queue\+Sound (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{tag}{, }\item[{const std\+::string \&}]{path}{, }\item[{bool}]{loop}{}\end{DoxyParamCaption})}



Enqueues an asynchronous sound load job. 

Unlike textures/shaders/fonts, this does not check for existing registrations in the provided implementation. The \doxylink{struct_sound_job}{Sound\+Job} result is applied during \doxylink{class_loading_state_a8d02a948b169581ad59b589c67f1f589}{Upload\+To\+GPU()} by calling Sound\+Manager\+::\+Load\+Sound(tag, file\+Path, loop).


\begin{DoxyParams}{Parameters}
{\em tag} & Sound tag. \\
\hline
{\em path} & Sound file path. \\
\hline
{\em loop} & Whether the sound should loop. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00124}{124}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00125\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \mbox{\hyperlink{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219}{loader}}.Enqueue(SoundJob\{\ tag,\ path,\ loop\ \});}
\DoxyCodeLine{00127\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_af0573a8838bb173f6bd6c6a881931cd8}\index{LoadingState@{LoadingState}!QueueTexture@{QueueTexture}}
\index{QueueTexture@{QueueTexture}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{QueueTexture()}{QueueTexture()}}
{\footnotesize\ttfamily \label{class_loading_state_af0573a8838bb173f6bd6c6a881931cd8} 
void Loading\+State\+::\+Queue\+Texture (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&}]{engine\+Context}{, }\item[{const std\+::string \&}]{tag}{, }\item[{const std\+::string \&}]{file\+Path}{, }\item[{const \mbox{\hyperlink{struct_texture_settings}{Texture\+Settings}} \&}]{settings}{ = {\ttfamily \{\}}}\end{DoxyParamCaption})}



Enqueues an asynchronous texture load job if the texture tag is not already registered. 

If \doxylink{class_render_manager}{Render\+Manager} already has a texture registered for tag, the request is ignored. Otherwise, a \doxylink{struct_texture_job}{Texture\+Job} is enqueued into \doxylink{class_async_resource_loader}{Async\+Resource\+Loader}.


\begin{DoxyParams}{Parameters}
{\em engine\+Context} & Engine-\/wide context (used to query \doxylink{class_render_manager}{Render\+Manager}). \\
\hline
{\em tag} & \doxylink{class_texture}{Texture} tag to register under. \\
\hline
{\em file\+Path} & File path for the texture to load. \\
\hline
{\em settings} & \doxylink{class_texture}{Texture} sampling/wrap/mipmap settings applied when creating the GPU texture. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00099}{99}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00100\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordflow}{if}\ (engineContext.\mbox{\hyperlink{struct_engine_context_a8f4c861adc4684975fa767ae4723e095}{renderManager}}-\/>\mbox{\hyperlink{class_render_manager_a687a26c8df1f31684d40c4c122480194}{HasTexture}}(tag))}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00103\ \ \ \ \ \mbox{\hyperlink{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219}{loader}}.Enqueue(TextureJob\{\ tag,\ filePath,\ settings\ \});}
\DoxyCodeLine{00104\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_a3754de47c0b00b40517645df5e5625cf}\index{LoadingState@{LoadingState}!Unload@{Unload}}
\index{Unload@{Unload}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{Unload()}{Unload()}}
{\footnotesize\ttfamily \label{class_loading_state_a3754de47c0b00b40517645df5e5625cf} 
void Loading\+State\+::\+Unload (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&}]{engine\+Context}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Unloads the loading state. 

Currently a no-\/op in the provided implementation.


\begin{DoxyParams}{Parameters}
{\em engine\+Context} & Engine-\/wide context. \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{class_game_state_ab9a398de72a4201a69093dfd574220c6}{Game\+State}}.



Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00088}{88}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00089\ \{}
\DoxyCodeLine{00090\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_a56063d7d8b5ae48cbbee33d16aad3e93}\index{LoadingState@{LoadingState}!Update@{Update}}
\index{Update@{Update}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{Update()}{Update()}}
{\footnotesize\ttfamily \label{class_loading_state_a56063d7d8b5ae48cbbee33d16aad3e93} 
void Loading\+State\+::\+Update (\begin{DoxyParamCaption}\item[{float}]{dt}{, }\item[{const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&}]{engine\+Context}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Fetches completed load jobs, uploads results to GPU/systems, updates UI, and transitions when finished. 

Each frame\+:
\begin{DoxyItemize}
\item Calls loader.\+Fetch\+Completed() and uploads each \doxylink{_async_resource_loader_8h_a6a60ad85728d8591ed1f4246e5d3af21}{Load\+Result} via \doxylink{class_loading_state_a8d02a948b169581ad59b589c67f1f589}{Upload\+To\+GPU()}.
\item Updates the progress\+Text with the current percentage from \doxylink{class_loading_state_a2a2abd4d6eae2b9f012e02bdc718dd69}{Get\+Progress01()}.
\end{DoxyItemize}

When loader.\+Has\+Finished() becomes true and next\+Factory is valid\+:
\begin{DoxyItemize}
\item Fetches completed results again to flush any remaining uploads.
\item Calls engine\+Context.\+state\+Manager-\/\texorpdfstring{$>$}{>}Change\+State(next\+Factory()) to transition.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em dt} & Delta time in seconds. \\
\hline
{\em engine\+Context} & Engine-\/wide context. \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{class_game_state_a6d11e92e629e2d4cbba792faeb75a71f}{Game\+State}}.



Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00040}{40}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00041\ \{}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keyword}{auto}\ done\ =\ \mbox{\hyperlink{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219}{loader}}.FetchCompleted();}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ r\ :\ done)}
\DoxyCodeLine{00044\ \ \ \ \ \{}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_loading_state_a8d02a948b169581ad59b589c67f1f589}{UploadToGPU}}(r,\ engineContext);}
\DoxyCodeLine{00046\ \ \ \ \ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_loading_state_aecfe4e3c0b70523fe2f15935743340a3}{progressText}})}
\DoxyCodeLine{00049\ \ \ \ \ \{}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ pct\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(\mbox{\hyperlink{class_loading_state_a2a2abd4d6eae2b9f012e02bdc718dd69}{GetProgress01}}()\ *\ 100.0f);}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_loading_state_aecfe4e3c0b70523fe2f15935743340a3}{progressText}}-\/>SetText(\textcolor{stringliteral}{"{}Loading...\ "{}}\ +\ std::to\_string(pct)\ +\ \textcolor{stringliteral}{"{}\%"{}});}
\DoxyCodeLine{00052\ \ \ \ \ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219}{loader}}.HasFinished()\ \&\&\ \mbox{\hyperlink{class_loading_state_a40db3522932ae35699d1db2ab5d728b0}{nextFactory}})}
\DoxyCodeLine{00055\ \ \ \ \ \{}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ done\ =\ \mbox{\hyperlink{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219}{loader}}.FetchCompleted();}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ r\ :\ done)}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_loading_state_a8d02a948b169581ad59b589c67f1f589}{UploadToGPU}}(r,\ engineContext);}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ engineContext.\mbox{\hyperlink{struct_engine_context_a67f96c1b09ab0393d4f8434900d7419a}{stateManager}}-\/>\mbox{\hyperlink{class_state_manager_a5337ecd1c035794817b1de05f961d352}{ChangeState}}(\mbox{\hyperlink{class_loading_state_a40db3522932ae35699d1db2ab5d728b0}{nextFactory}}());}
\DoxyCodeLine{00062\ \ \ \ \ \}}
\DoxyCodeLine{00063\ \}}

\end{DoxyCode}
\Hypertarget{class_loading_state_a8d02a948b169581ad59b589c67f1f589}\index{LoadingState@{LoadingState}!UploadToGPU@{UploadToGPU}}
\index{UploadToGPU@{UploadToGPU}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{UploadToGPU()}{UploadToGPU()}}
{\footnotesize\ttfamily \label{class_loading_state_a8d02a948b169581ad59b589c67f1f589} 
void Loading\+State\+::\+Upload\+To\+GPU (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{_async_resource_loader_8h_a6a60ad85728d8591ed1f4246e5d3af21}{Load\+Result}} \&}]{r}{, }\item[{const \mbox{\hyperlink{struct_engine_context}{Engine\+Context}} \&}]{engine\+Context}{}\end{DoxyParamCaption})}



Applies a completed load result to engine runtime systems (GPU upload / registration). 

Uses std\+::visit on the \doxylink{_async_resource_loader_8h_a6a60ad85728d8591ed1f4246e5d3af21}{Load\+Result} variant\+:
\begin{DoxyItemize}
\item \doxylink{struct_texture_result}{Texture\+Result}\+:
\begin{DoxyItemize}
\item Creates a \doxylink{class_texture}{Texture} from raw pixel data and registers it to \doxylink{class_render_manager}{Render\+Manager} under the result tag.
\end{DoxyItemize}
\item \doxylink{struct_shader_result}{Shader\+Result}\+:
\begin{DoxyItemize}
\item Creates a \doxylink{class_shader}{Shader}, attaches sources, links it, then registers it to \doxylink{class_render_manager}{Render\+Manager}.
\end{DoxyItemize}
\item \doxylink{struct_font_result}{Font\+Result}\+:
\begin{DoxyItemize}
\item Registers the font to \doxylink{class_render_manager}{Render\+Manager} via Register\+Font(tag, ttf\+Path, pixel\+Size).
\end{DoxyItemize}
\item \doxylink{struct_sound_result}{Sound\+Result}\+:
\begin{DoxyItemize}
\item Registers the sound via Sound\+Manager\+::\+Load\+Sound(tag, file\+Path, loop).
\end{DoxyItemize}
\end{DoxyItemize}

Failed results (ok == false) are skipped for \doxylink{struct_texture_result}{Texture\+Result} and \doxylink{struct_shader_result}{Shader\+Result}.


\begin{DoxyParams}{Parameters}
{\em r} & Completed load result. \\
\hline
{\em engine\+Context} & Engine-\/wide context providing \doxylink{class_render_manager}{Render\+Manager} and \doxylink{class_sound_manager}{Sound\+Manager}. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{_loading_state_8cpp_source_l00132}{132}} of file \mbox{\hyperlink{_loading_state_8cpp_source}{Loading\+State.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00133\ \{}
\DoxyCodeLine{00134\ \ \ \ \ std::visit([\&](\textcolor{keyword}{auto}\&\&\ res)}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{using\ }T\ =\ std::decay\_t<\textcolor{keyword}{decltype}(res)>;}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<T,\ TextureResult>)}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!res.ok)}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ tex\ =\ std::make\_unique<Texture>(res.pixels.data(),\ res.width,\ res.height,\ res.channels,\ res.settings);}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ engineContext.\mbox{\hyperlink{struct_engine_context_a8f4c861adc4684975fa767ae4723e095}{renderManager}}-\/>\mbox{\hyperlink{class_render_manager_a8645efdc911bde8ae83409d18a2d9cfd}{RegisterTexture}}(res.tag,\ std::move(tex));}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<T,\ ShaderResult>)}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!res.ok)}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ shader\ =\ std::make\_unique<Shader>();}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ s\ :\ res.sources)}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shader-\/>AttachFromSource(s.stage,\ s.source);}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!shader-\/>Link())}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ JIN\_ERR(\textcolor{stringliteral}{"{}Shader\ link\ failed\ (tag="{}}\ <<\ res.tag\ <<\ \textcolor{stringliteral}{"{})"{}});}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ engineContext.\mbox{\hyperlink{struct_engine_context_a8f4c861adc4684975fa767ae4723e095}{renderManager}}-\/>\mbox{\hyperlink{class_render_manager_a3ad25e59a96852a1685a0eba9898d11d}{RegisterShader}}(res.tag,\ std::move(shader));}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<T,\ FontResult>)}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ engineContext.\mbox{\hyperlink{struct_engine_context_a8f4c861adc4684975fa767ae4723e095}{renderManager}}-\/>\mbox{\hyperlink{class_render_manager_a0762465f3bfa7573ec3261767a68eb16}{RegisterFont}}(res.tag,\ res.ttfPath,\ res.pixelSize);}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<T,\ SoundResult>)}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ engineContext.\mbox{\hyperlink{struct_engine_context_aa5985216cfd74ab389769abc5a5fdfb6}{soundManager}}-\/>\mbox{\hyperlink{class_sound_manager_a8e52926369f4ff23599507c5e7cf7246}{LoadSound}}(res.tag,\ res.filePath,\ res.loop);}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \},\ r);}
\DoxyCodeLine{00171\ \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\Hypertarget{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219}\index{LoadingState@{LoadingState}!loader@{loader}}
\index{loader@{loader}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{loader}{loader}}
{\footnotesize\ttfamily \label{class_loading_state_af7bd294a5dfe6f36c4e6291bf64aa219} 
\mbox{\hyperlink{class_async_resource_loader}{Async\+Resource\+Loader}} Loading\+State\+::loader\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line \mbox{\hyperlink{_loading_state_8h_source_l00228}{228}} of file \mbox{\hyperlink{_loading_state_8h_source}{Loading\+State.\+h}}.

\Hypertarget{class_loading_state_a40db3522932ae35699d1db2ab5d728b0}\index{LoadingState@{LoadingState}!nextFactory@{nextFactory}}
\index{nextFactory@{nextFactory}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{nextFactory}{nextFactory}}
{\footnotesize\ttfamily \label{class_loading_state_a40db3522932ae35699d1db2ab5d728b0} 
std\+::function$<$std\+::unique\+\_\+ptr$<$\mbox{\hyperlink{class_game_state}{Game\+State}}$>$()$>$ Loading\+State\+::next\+Factory\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line \mbox{\hyperlink{_loading_state_8h_source_l00229}{229}} of file \mbox{\hyperlink{_loading_state_8h_source}{Loading\+State.\+h}}.

\Hypertarget{class_loading_state_aecfe4e3c0b70523fe2f15935743340a3}\index{LoadingState@{LoadingState}!progressText@{progressText}}
\index{progressText@{progressText}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{progressText}{progressText}}
{\footnotesize\ttfamily \label{class_loading_state_aecfe4e3c0b70523fe2f15935743340a3} 
\mbox{\hyperlink{class_text_object}{Text\+Object}}\texorpdfstring{$\ast$}{*} Loading\+State\+::progress\+Text = nullptr\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line \mbox{\hyperlink{_loading_state_8h_source_l00233}{233}} of file \mbox{\hyperlink{_loading_state_8h_source}{Loading\+State.\+h}}.

\Hypertarget{class_loading_state_a27df9fbc8edb1b1a7f2ec5d52af2f50f}\index{LoadingState@{LoadingState}!uiFontTag@{uiFontTag}}
\index{uiFontTag@{uiFontTag}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{uiFontTag}{uiFontTag}}
{\footnotesize\ttfamily \label{class_loading_state_a27df9fbc8edb1b1a7f2ec5d52af2f50f} 
std\+::string Loading\+State\+::ui\+Font\+Tag = "{}\mbox{[}Loading\mbox{]}UIFont"{}\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line \mbox{\hyperlink{_loading_state_8h_source_l00231}{231}} of file \mbox{\hyperlink{_loading_state_8h_source}{Loading\+State.\+h}}.

\Hypertarget{class_loading_state_aebe9d65f3f4ff289a2d0b76f020e5c1e}\index{LoadingState@{LoadingState}!uiReady@{uiReady}}
\index{uiReady@{uiReady}!LoadingState@{LoadingState}}
\doxysubsubsection{\texorpdfstring{uiReady}{uiReady}}
{\footnotesize\ttfamily \label{class_loading_state_aebe9d65f3f4ff289a2d0b76f020e5c1e} 
bool Loading\+State\+::ui\+Ready = false\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line \mbox{\hyperlink{_loading_state_8h_source_l00232}{232}} of file \mbox{\hyperlink{_loading_state_8h_source}{Loading\+State.\+h}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
Project/\+Jin\+Engine/\+Public/\mbox{\hyperlink{_loading_state_8h}{Loading\+State.\+h}}\item 
Project/\+Jin\+Engine/\+Private/\mbox{\hyperlink{_loading_state_8cpp}{Loading\+State.\+cpp}}\end{DoxyCompactItemize}
